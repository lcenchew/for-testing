!function(){"use strict";let t;function i(t,i,s){return Math.min(Math.max(t,s),i)}class s{constructor(t=0,i=0,s={}){this.x=t,this.y=i,s._c&&(this.clamp(s._a,s._b,s._d,s._e),this.x=t,this.y=i)}add(t){return new s(this.x+t.x,this.y+t.y,this)}subtract(t){return new s(this.x-t.x,this.y-t.y,this)}scale(t){return new s(this.x*t,this.y*t)}normalize(t=this.length()){return new s(this.x/t,this.y/t)}dot(t){return this.x*t.x+this.y*t.y}length(){return Math.hypot(this.x,this.y)}distance(t){return Math.hypot(this.x-t.x,this.y-t.y)}angle(t){return Math.acos(this.dot(t)/(this.length()*t.length()))}clamp(t,i,s,e){this._c=!0,this._a=t,this._b=i,this._d=s,this._e=e}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?i(this._a,this._d,t):t}set y(t){this._y=this._c?i(this._b,this._e,t):t}}function e(){return new s(...arguments)}e.prototype=s.prototype,e.class=s;var h={i(){this.acceleration=e()},get ddx(){return this.acceleration.x},get ddy(){return this.acceleration.y},set ddx(t){this.acceleration.x=t},set ddy(t){this.acceleration.y=t}},r={i(){this.anchor={x:0,y:0}}},n={i(){this.sx=this.sy=0},get viewX(){return this.x-this.sx},get viewY(){return this.y-this.sy},set viewX(t){},set viewY(t){},get sx(){return this._sx},get sy(){return this._sy},set sx(t){this.children.map(i=>{i.sx+=t-this._sx}),this._sx=t},set sy(t){this.children.map(i=>{i.sy+=t-this._sy}),this._sy=t}};let a={i(){this.children=[]},adChild(t,{absolute:i=!1}={}){this.children.push(t),t.parent=this,t.x=i?t.x:this.x+t.x,t.y=i?t.y:this.y+t.y,t.rotation=this.rotation+t.rotation,t.setScale&&t.setScale(this.scale.x,this.scale.y),"sx"in t&&(t.sx=i?t.sx:this.sx+t.sx,t.sy=i?t.sy:this.sy+t.sy),t._fop=this.opacity*t.opacity},removeChild(t){let i=this.children.indexOf(t);-1!==i&&(this.children.splice(i,1),t.parent=null)}};var o={i(){this.opacity=1},get finalOpacity(){let t=this.opacity;return t=this._fop},set finalOpacity(t){},get opacity(){return this._op},set opacity(t){this._fop=this.parent&&this.parent._fop?t*this.parent._fop:t,this.children.map(t=>{t.opacity=t.opacity}),this._op=t}},c={i(){this.position=e(),this.width=this.height=0},get x(){return this.position.x},get y(){return this.position.y},set x(t){this.children.map(i=>{i.x+=t-this.position.x}),this.position.x=t},set y(t){this.children.map(i=>{i.y+=t-this.position.y}),this.position.y=t}},l={i(){this.context=t},render(){let t=this.context;t.save();let i=this.x,s=this.y;if("viewX"in this&&(i=this.viewX,s=this.viewY),(i||s)&&t.translate(i,s),this.rotation&&t.rotate(this.rotation),"scale"in this){let{x:i,y:s}=this.scale;1==i&&1==s||t.scale(scaleX,scaleY)}if("anchor"in this){let{x:i,y:s}=this.anchor,e=-this.width*i,h=-this.height*s;(e||h)&&t.translate(e,h)}this.context.globalAlpha=this.finalOpacity,this._rf(),t.restore()}},y={i(){this.rotation=0},get rotation(){return this._rot},set rotation(t){this.children.map(i=>{i.rotation+=t-this._rot}),this._rot=t}},x={i(){this.scale={x:1,y:1}},setScale(t,i=t){this.children.map(s=>{s.setScale&&s.setScale(s.scale.x+t-this.scale.x,s.scale.y+i-this.scale.y)}),this.scale={x:t,y:i}},get scaledWidth(){return this.width*this.scale.x},get scaledHeight(){return this.height*this.scale.y},set scaledWidth(t){},set scaledHeight(t){}},d={i(){this.ttl=0},isAlive(){return this.ttl>0}},p={i(){this.velocity=e()},get dx(){return this.velocity.x},get dy(){return this.velocity.y},set dx(t){this.velocity.x=t},set dy(t){this.velocity.y=t}};class u{constructor(t){return this.init(t)}init(t={}){[a,c,l,h,r,n,o,y,x,d,p].map(t=>{let{i:i,...s}=Object.getOwnPropertyDescriptors(t);Object.defineProperties(this,s),i&&i.value.call(this)});let{render:i,...s}=t;Object.assign(this,s),this._rf=i||this.draw}draw(){}update(t){this.advance(t)}advance(t){this.velocity=this.velocity.add(this.acceleration,t),this.position=this.position.add(this.velocity,t),this.ttl--}}function _(){return new u(...arguments)}_.prototype=u.prototype,_.class=u;_({x:10,y:10,width:20,height:40,color:"red",render(){this.context.fillStyle="red",this.context.fillRect(0,0,this.width,this.height)}})}();